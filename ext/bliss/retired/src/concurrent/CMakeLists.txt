set(TEST_NAME bliss-concurrent)
include("${PROJECT_SOURCE_DIR}/cmake/Sanitizer.cmake")
include("${PROJECT_SOURCE_DIR}/cmake/ExtraWarnings.cmake")


if (ENABLE_TESTING)
# load the testing:
if (IS_DIRECTORY ./test)

    bliss_add_relacy_test(${TEST_NAME} FALSE test/relacy_practice.cpp USE_RELACY )

    bliss_add_relacy_test(${TEST_NAME} FALSE test/relacy_copyable_atomics.cpp USE_RELACY )

    bliss_add_relacy_test(${TEST_NAME} FALSE test/relacy_buffer.cpp BLISS_MUTEX BLISS_LOCKFREE BLISS_NONE)
    bliss_add_relacy_test(${TEST_NAME} FALSE test/relacy_threadsafe_queue.cpp BLISS_MUTEX BLISS_LOCKFREE )

    bliss_add_relacy_test(${TEST_NAME} FALSE test/relacy_objectpool.cpp BLISS_MUTEX BLISS_LOCKFREE BLISS_NONE)

    # get all files from ./test
    FILE(GLOB CHECK_FILES test/check_*.cpp)
    bliss_add_non_google_test(${TEST_NAME} FALSE ${CHECK_FILES})    
    
    bliss_add_metaprog_test(${TEST_NAME} FALSE test/check2_buffer.cpp BLISS_MUTEX BLISS_LOCKFREE)
    bliss_add_metaprog_test(${TEST_NAME} FALSE test/check2_buffer_performance.cpp BLISS_MUTEX BLISS_LOCKFREE )
    
    bliss_add_metaprog_test(${TEST_NAME} FALSE test/check2_objectpool.cpp BLISS_MUTEX )
    bliss_add_metaprog_test(${TEST_NAME} FALSE test/check2_objectpool_performance.cpp BLISS_MUTEX )

    bliss_add_metaprog_test(${TEST_NAME} FALSE test/check2_objectpool_lf.cpp BLISS_LOCKFREE)
    bliss_add_metaprog_test(${TEST_NAME} FALSE test/check2_objectpool_performance_lf.cpp BLISS_LOCKFREE )

    bliss_add_metaprog_test(${TEST_NAME} FALSE test/check2_threadsafe_queue.cpp BLISS_MUTEX BLISS_LOCKFREE )
    bliss_add_metaprog_test(${TEST_NAME} FALSE test/check2_threadsafe_queue_performance.cpp BLISS_NONE BLISS_MUTEX BLISS_LOCKFREE )
    
endif()

endif()
